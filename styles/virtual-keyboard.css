/* ===== VIRTUAL-KEYBOARD.CSS - CLAVIER VIRTUEL RESPONSIVE CSS PURE ===== */

/* ===== CONTENEUR PRINCIPAL ===== */

.keyboard {
    /* Par défaut caché - L'affichage est géré par les media queries */
    display: none;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-xl);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

/* ===== AFFICHAGE RESPONSIVE CSS PURE ===== */

/* DESKTOP : Masquage forcé (>1024px) */
@media (min-width: 1025px) {
    .keyboard {
        display: none !important;
    }
}

/* MOBILE/TABLETTE : Affichage automatique (≤1024px) */
@media (max-width: 1024px) {
    .keyboard {
        display: flex;
    }
    
    /* Masquer si le conteneur est vide (pas de touches générées) */
    .keyboard:empty {
        display: none !important;
    }
    
    /* Animation d'apparition pour les claviers avec contenu */
    .keyboard:not(:empty) {
        animation: keyboardSlideIn 0.3s ease-out;
    }
}

/* ===== LIGNES DU CLAVIER ===== */

.keyboard-row {
    display: flex;
    justify-content: center;
    gap: var(--spacing-xs);
}

/* Ligne des chiffres - pas de décalage */
.keyboard-row-numbers {
    justify-content: center;
}

/* Lignes AZERTY avec décalages progressifs */
.keyboard-row-azerty.keyboard-row-1 {
    /* Première ligne AZERTY - pas de décalage */
    justify-content: center;
}

.keyboard-row-azerty.keyboard-row-2 {
    /* Deuxième ligne AZERTY - petit décalage */
    padding-left: 25px;
}

.keyboard-row-azerty.keyboard-row-3 {
    /* Troisième ligne AZERTY - gros décalage */
    padding-left: 50px;
}

/* ===== BOUTONS DU CLAVIER ===== */

.keyboard button {
    background: rgba(233, 69, 96, 0.2);
    color: #fff;
    border: 1px solid rgba(233, 69, 96, 0.5);
    padding: 0.8rem;
    font-size: 1.2rem;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition-normal);
    font-family: inherit;
}

.keyboard button:hover:not(:disabled) {
    background: rgba(233, 69, 96, 0.4);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(233, 69, 96, 0.3);
}

.keyboard button:active:not(:disabled) {
    transform: scale(0.95);
    transition: transform 0.1s ease;
}

.keyboard button:disabled {
    cursor: not-allowed;
}

/* Boutons disabled sans état spécial (gris) */
.keyboard button:disabled:not(.correct):not(.wrong) {
    background: rgba(0, 0, 0, 0.5);
    color: #666;
    transform: scale(0.95);
}

/* ===== ÉTATS DES BOUTONS ===== */

.keyboard button.correct {
    background: #2ed573 !important;
    border-color: #27ae60;
    color: #fff !important;
    box-shadow: 0 2px 8px rgba(46, 213, 115, 0.4);
}

.keyboard button.wrong {
    background: #e74c3c !important;
    border-color: #c0392b;
    color: #fff !important;
    box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4);
}

/* ===== TYPES DE TOUCHES ===== */

/* Touches de chiffres */
.keyboard button.key-number {
    background: rgba(52, 152, 219, 0.2);
    border-color: rgba(52, 152, 219, 0.5);
    color: #3498db;
    font-weight: bold;
}

.keyboard button.key-number:hover:not(:disabled) {
    background: rgba(52, 152, 219, 0.4);
    box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
}

/* Touches de lettres standard */
.keyboard button.key-letter {
    /* Styles par défaut déjà définis ci-dessus */
}

/* ===== TOUCHES AVEC ACCENTS ===== */

/* Boutons avec accents disponibles */
.keyboard button.has-accents {
    position: relative;
}

.keyboard button .accent-indicator {
    position: absolute;
    top: 2px;
    right: 4px;
    font-size: 8px;
    color: var(--primary-color);
    opacity: 0.8;
    transition: color var(--transition-fast);
}

/* ===== POPUP D'ACCENTS ===== */

.accent-popup {
    background: var(--bg-secondary);
    border: 2px solid var(--primary-color);
    border-radius: var(--radius-lg);
    padding: var(--spacing-sm);
    display: flex;
    gap: var(--spacing-xs);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    opacity: 0;
    transform: translateX(-50%) translateY(10px);
    transition: all 0.2s ease;
    pointer-events: none; /* Empêche les clics directs */
}

.accent-popup.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* ===== BOUTONS D'ACCENTS DANS LE POPUP ===== */

.accent-popup .accent-option {
    background: rgba(243, 156, 18, 0.2);
    color: var(--text-primary);
    border: 1px solid var(--primary-color);
    padding: 0.6rem 0.8rem;
    font-size: 1.1rem;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
    font-family: inherit;
    min-width: 40px;
    pointer-events: auto; /* Réactive les événements pour les boutons */
}

.accent-popup .accent-option:hover,
.accent-popup .accent-option:active,
.accent-popup .accent-option.selected {
    background: var(--primary-color);
    color: white;
    transform: scale(1.1);
    box-shadow: 0 0 10px rgba(243, 156, 18, 0.5);
}

/* États des accents déjà essayés */
.accent-popup .accent-option.correct {
    background: #2ed573 !important;
    color: white !important;
    border-color: #27ae60;
    box-shadow: 0 2px 8px rgba(46, 213, 115, 0.4);
}

.accent-popup .accent-option.wrong {
    background: #e74c3c !important;
    color: white !important;
    border-color: #c0392b;
    box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4);
}

/* La sélection override les états correct/wrong */
.accent-popup .accent-option.selected {
    background: var(--primary-color) !important;
    color: white !important;
    transform: scale(1.1);
    box-shadow: 0 0 10px rgba(243, 156, 18, 0.5) !important;
}

/* ===== ANIMATIONS ===== */

@keyframes keyboardSlideIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ===== RESPONSIVE ADAPTATIF PAR TAILLE D'ÉCRAN ===== */

/* TABLETTE (769px - 1024px) : Clavier compact */
@media (max-width: 1024px) and (min-width: 769px) {
    .keyboard {
        max-width: 500px;
    }
    
    .keyboard button {
        min-width: 40px;
        height: 40px;
        font-size: 0.9rem;
    }
    
    .keyboard-row-azerty.keyboard-row-2 {
        padding-left: 20px;
    }
    
    .keyboard-row-azerty.keyboard-row-3 {
        padding-left: 40px;
    }
}

/* MOBILE STANDARD (481px - 768px) : Clavier optimisé */
@media (max-width: 768px) {
    .keyboard {
        max-width: 100%;
        padding: 0 var(--spacing-sm);
    }
    
    .keyboard button {
        min-width: 35px;
        height: 45px;
        font-size: 1rem;
    }
}

/* PETIT MOBILE (320px - 480px) : Clavier très compact */
@media (max-width: 480px) {
    .keyboard button {
        min-width: 32px;
        height: 42px;
        font-size: 0.9rem;
    }
    
    .keyboard-row-azerty.keyboard-row-2 {
        padding-left: 16px; /* Décalage réduit */
    }
    
    .keyboard-row-azerty.keyboard-row-3 {
        padding-left: 32px; /* Décalage réduit */
    }
}

/* TRÈS PETIT MOBILE (≤320px) : Clavier minimal */
@media (max-width: 320px) {
    .keyboard {
        gap: 4px;
        margin-bottom: var(--spacing-md);
    }
    
    .keyboard-row {
        gap: 3px;
    }
    
    .keyboard button {
        min-width: 28px;
        height: 38px;
        font-size: 0.8rem;
        padding: var(--spacing-xs);
    }
    
    .keyboard-row-azerty.keyboard-row-2 {
        padding-left: 12px;
    }
    
    .keyboard-row-azerty.keyboard-row-3 {
        padding-left: 24px;
    }
}

/* ===== MODE PLEIN ÉCRAN RESPONSIVE ===== */

/* Mobile en plein écran - Clavier 100% responsive avec fixes mobiles */
@media (max-width: 1024px) {
    .fullscreen-mode .keyboard {
        padding: 1.5%; /* Padding en pourcentage de la largeur */
        gap: 0.8%; /* Gap en pourcentage */
        width: 100vw; /* Force la largeur viewport */
        max-width: 100vw; /* Empêche le débordement */
        margin: 0 auto;
        box-sizing: border-box;
        /* Fixes spécifiques mobile réel */
        overflow-x: hidden;
        transform: translateZ(0); /* Force accélération GPU */
    }
    
    .fullscreen-mode .keyboard-row {
        gap: 0.8%; /* Gap uniforme en pourcentage */
        justify-content: center;
        width: 100%;
        max-width: 100%;
        display: flex;
        overflow-x: hidden; /* Empêche le débordement horizontal */
        flex-wrap: nowrap; /* Empêche le retour à la ligne */
    }
    
    .fullscreen-mode .keyboard button {
        flex: 1; /* Répartition égale automatique */
        padding: 2.5% 1%; /* Padding en pourcentage */
        font-size: 1.1rem; /* Taille fixe similaire au mode normal */
        min-width: 0; /* Pas de contrainte minimale */
        height: 8vh; /* Hauteur en fonction de la hauteur d'écran */
        white-space: nowrap;
        overflow: hidden;
        border-radius: var(--radius-sm);
        /* Fixes spécifiques pour mobile réel */
        box-sizing: border-box; /* Inclut padding/border dans la largeur */
        flex-shrink: 1; /* Permet la compression si nécessaire */
        max-width: none; /* Pas de limite de largeur */
    }
    
    /* Décalages AZERTY pour plein écran - décalages en pourcentage */
    .fullscreen-mode .keyboard-row-azerty.keyboard-row-2 {
        padding-left: 5%; /* Décalage proportionnel */
    }
    
    .fullscreen-mode .keyboard-row-azerty.keyboard-row-3 {
        padding-left: 12%; /* Décalage proportionnel plus important */
    }
}

/* Très petit écran en plein écran - même logique 100% responsive */
@media (max-width: 480px) {
    .fullscreen-mode .keyboard {
        padding: 1.2%; /* Padding légèrement réduit */
        gap: 0.6%; /* Gap réduit */
    }
    
    .fullscreen-mode .keyboard-row {
        gap: 0.6%; /* Gap cohérent */
        width: 100%;
    }
    
    .fullscreen-mode .keyboard button {
        flex: 1; /* Toujours répartition égale */
        padding: 2% 0.8%; /* Padding réduit en pourcentage */
        font-size: 1rem; /* Taille normale légèrement réduite */
        min-width: 0; /* Pas de contrainte */
        height: 7vh; /* Hauteur réduite */
        /* Aucune contrainte max-width */
    }
    
    /* Ajustements AZERTY pour plein écran petits écrans */
    .fullscreen-mode .keyboard-row-azerty.keyboard-row-2 {
        padding-left: 4%; /* Décalage légèrement réduit */
    }
    
    .fullscreen-mode .keyboard-row-azerty.keyboard-row-3 {
        padding-left: 10%; /* Décalage réduit mais proportionnel */
    }
}

/* ===== FIXES SPÉCIFIQUES MOBILES RÉELS ===== */

/* Solution pour le débordement mobile réel vs DevTools */
@media (max-width: 1024px) {
    .fullscreen-mode .keyboard {
        /* Force le calcul de largeur réel */
        width: calc(100vw - 4px); /* Légère marge pour sécurité */
        max-width: calc(100vw - 4px);
        /* Position pour éviter les décalages webkit */
        position: relative;
        left: 0;
        right: 0;
        /* Marge négative pour compenser le padding parent si nécessaire */
        margin-left: auto;
        margin-right: auto;
    }
    
    .fullscreen-mode .keyboard-row {
        /* Force recalcul sur mobile réel */
        width: calc(100% - 2px);
        max-width: 100%;
        margin: 0 auto;
    }
    
    .fullscreen-mode .keyboard button {
        /* Assure que les boutons rentrent vraiment */
        flex-basis: 0;
        flex-grow: 1;
        flex-shrink: 1;
        /* Padding adaptatif plus sûr */
        padding: min(2.5%, 8px) min(1%, 4px);
        /* Border-box absolu */
        box-sizing: border-box !important;
    }
}

/* Fix pour très petits écrans où le problème est plus critique */
@media (max-width: 480px) {
    .fullscreen-mode .keyboard {
        width: calc(100vw - 8px); /* Marge plus importante */
        max-width: calc(100vw - 8px);
        padding: 1% 0.5%; /* Padding réduit */
        gap: 0.5%; /* Gap réduit */
    }
    
    .fullscreen-mode .keyboard-row {
        gap: 0.5%;
        width: calc(100% - 4px);
    }
    
    .fullscreen-mode .keyboard button {
        padding: min(2%, 6px) min(0.8%, 2px);
        border-width: 1px; /* Border plus fine pour économiser l'espace */
    }
}